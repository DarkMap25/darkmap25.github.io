/* 1. Styles généraux === */
body {
  margin: 0; /* Suppression des marges par défaut */
  padding: 0; /* Suppression des espacements par défaut */
  background-color: #0d0d0d; /* Couleur de fond de secours si l'image échoue */
  background-image: url('./icons/background.jpg'); /* Image de fond */
  background-size: cover; /* La taille de l'image couvre tout l'écran */
  background-position: center; /* L'image est centrée */
  background-repeat: no-repeat; /* L'image ne se répète pas */
  background-attachment: scroll; /* Le fond défile avec la page (plus compatible mobile) */
  color: #f0f0f0; /* Couleur du texte */
  font-family: 'Quicksand', sans-serif; /* Police du texte */
  position: relative; /* Positionnement pour le calque noir transparent */
}

/* 2. Calque noir transparent par-dessus l'image */
body::before {
  content: ""; /* Contenu vide pour un pseudo-élément */
  position: fixed; /* Position fixe pour couvrir toute la fenêtre */
  top: 0; /* Commence en haut de la page */
  left: 0; /* Commence à gauche de la page */
  width: 100%; /* Prend toute la largeur de l'écran */
  height: 100%; /* Prend toute la hauteur de l'écran */
  background: rgba(0, 0, 0, 0.2); /* Calque noir avec transparence */
  z-index: -1; /* Placer ce calque derrière le contenu principal */
}

/* 3. Structure site ===== */

/* 3.0 Variables de configuration (modifiable : hauteur en vh, tailles, couleurs…) */
:root {
  /* hauteurs des sections (total = 100vh) */
  --header-height: 18vh;
  --map-height:    70vh;
  --intro-height:  8vh;
  --footer-height:  4vh;

  /* typographies & couleurs */
  --header-h1-font-size:      4em;
  --header-h1-color:          #e60000;
  --header-h1-shadow:         0 0 8px #e60000;
  --header-tagline-font-size: 1em;
  --intro-font-size:          1em;
  --footer-font-size:         0.6em;
}

/* 3.1 Mise en page flex-colonne full viewport */
html, body {
  height: 100vh;
  margin: 0;
  padding: 0;
}
body {
  display: flex;
  flex-direction: column;
}

/* 3.2 Hauteurs des sections principales */
header {
  height: var(--header-height);
  display: flex;
  justify-content: flex-start;  /* aligne en haut */  
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 0em;               /* espace entre le h1 et la .tagline */
  padding-top: 0;               /* aucun padding supplémentaire */
}

#map {
  height: var(--map-height);
  margin: 0 auto;
  margin-bottom: 0;    /* supprime l’espace sous la carte */
  width: 80vw;
  border-radius: 10px;
  box-shadow: 0 0 10px #e60000;
  z-index: 1;
}

.intro {
  height: var(--intro-height);
  width: 100vw;
  margin: 0 auto;
  margin-top: 1em;   /* petit espacement si tu veux quand même un peu de “respiration”  */
  padding: 10px;
  font-size: var(--intro-font-size);
  line-height: 1;
  align-items: center;
  justify-content: center; 
  white-space: nowrap;      /* tout le texte reste sur une seule ligne */
  overflow: visible; /* pas de scroll interne */
}

footer {
  display: flex;
  flex-direction: column;   /* empile les paragraphes */
  align-items: center;      /* centre horizontalement */
  justify-content: center;  /* centre verticalement si nécessaire */
  padding: 0.5em 0;         /* espace réduit top/bottom */
  font-size: var(--footer-font-size);
  line-height: 1.2;         /* contrôle l’interligne */
  margin-top: auto;         /* pousse le footer en bas de la page */
}

footer p {
  margin: 0;                /* enlève marges par défaut */
  padding: 0;
}

footer p + p {
  margin-top: 0.4em;        /* petit écart entre la 1ère et la 2ème ligne */
}
/* 3.3 Styles du header (titre + sous-titre) */
header h1 {
  margin: 0;
  margin-bottom: 0em;
  font-size: var(--header-h1-font-size);
  font-family: 'Quicksand', sans-serif;
  font-weight: 700;
  text-align: center;
  color: var(--header-h1-color);
  text-shadow: var(--header-h1-shadow);
}

header .tagline {
  margin: 0;
  font-size: var(--header-tagline-font-size);
  color: var(--header-h1-color);
  margin-top: 0;                /* plus de marge au-dessus de la tagline */
  line-height: 1;               /* compactage vertical */  
  display: block;               /* s’assurer qu’elle n’est pas inline ou cachée */
  text-align: center;
}

/* 8. Optimisation pour mobile === */
@media (max-width: 768px) {
  /* 8.1 Réduire la taille de la carte sur les écrans plus petits */
   body {
    background-image: url('./icons/background.jpg'); /* Image différente pour mobile */
    background-size: cover; /* Adapter l'image pour qu'elle soit rognée */
    background-position: center center; /* Centrer l'image sur l'écran */
  }  
  #map {
    height: 60vh; /* Hauteur réduite de la carte sur mobile */
    max-width: 80%; /* Largeur réduite sur mobile */
    margin: 0 auto; /* Centrer la carte horizontalement */
    border-radius: 5px; /* Coins arrondis plus petits */
  }
  
  /* Ajuster le titre et l'introduction pour les écrans mobiles */
  h1 {
    font-size: 1.5em; /* Réduire la taille du titre sur mobile */
  }

  .intro {
    font-size: 0.6em; /* Réduire la taille du texte d'introduction */
    margin: 20px auto; /* Espacement autour du texte */
  }
  /* Ajuster la taille du texte d'introduction */
  #intro-text {
    font-size: 0.5em; /* Réduire la taille du texte d'intro */
  }  /* Retirer le 'background-attachment: fixed;' pour les mobiles */
  body {
    background-attachment: scroll; /* Fond défilant sur les petits écrans */
  }
}

/* 8.2 Pour les très petits écrans (moins de 480px) */
@media (max-width: 480px) {
  /* Ajustement spécifique pour les écrans très petits (comme l'iPhone SE) */
  body {
    background-image: url('./icons/background.jpg'); /* Image différente pour mobile */
    background-size: cover; /* Adapter l'image pour qu'elle soit rognée */
    background-position: center center; /* Centrer l'image sur l'écran */
  }  
  #map {
    height: 60vh; /* Réduire encore la hauteur de la carte sur les très petits écrans */
    width: 80%; /* Réduire la largeur à 90% */
    margin: 0 auto; /* Centrer la carte */
    border-radius: 5px; /* Coins arrondis */
    box-shadow: none; /* Retirer l'ombre pour un aspect plus léger */
  }
  
  h1 {
    font-size: 1.5em; /* Réduire encore la taille du titre */
  }

  .intro {
    font-size: 0.5em; /* Réduire encore la taille du texte d'introduction */
  }

  /* Ajuster la taille du texte d'introduction */
  #intro-text {
    font-size: 0.3em; /* Réduire la taille du texte d'intro */
  }
}

/* 9. Pied de page === */
footer {
  text-align: justify; /* Centrer le texte du pied de page */
  padding: 20px; /* Espacement autour du pied de page */
  font-size: 0.4em; /* Taille de la police */
  color: #777; /* Couleur gris pour le texte */
}

/* 10. Marqueurs emoji === */
.emoji-marker {
  font-size: 16px; /* Taille des marqueurs emoji */
  background: none; /* Pas de fond */
  border: none; /* Pas de bordure */
  box-shadow: none; /* Pas d'ombre */
  width: auto; /* Taille automatique */
  height: auto; /* Taille automatique */
  line-height: 1; /* Hauteur de ligne pour centrer */
  color: inherit; /* Couleur héritée du parent */
}

/* === 10.3 DetailPanel : fullscreen uniquement quand ouvert === */
/* Par défaut, on le cache et on ne définit PAS sa hauteur ici */
#detailPanel {
  display: none;
}

/* Quand on l’ouvre (classes .visible + .full-view) */
#detailPanel.visible.full-view {
  display: block;
  position: fixed;
  inset: 0;           /* top/right/bottom/left = 0 */
  z-index: 1000;
  padding: 20px;
  background-image: url('./icons/panneau.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  overflow: auto;
  /* couleurs et polices Darkmap */
  color: #e0d6cc;
  font-family: 'Cormorant Garamond', serif;
  text-shadow: 1px 1px 2px #000;
}

/* Croix de fermeture */
#closeDetailPanel {
  display: none;
  position: fixed;
  top: 20px;
  right: 20px;
  background-color: #900;
  color: #fff;
  border: none;
  font-size: 24px;
  padding: 8px 12px;
  border-radius: 4px;
  cursor: pointer;
  z-index: 2001;
}
#detailPanel.visible #closeDetailPanel {
  display: block;
}

/* 11. PERSONNALISATION DU BOUTON DE CHANGEMENT DE CARTE (Contrôle Leaflet) === */

.leaflet-control-layers {
  color: #1a001a; /* texte sombre pour le contraste */
  font-family: 'Quicksand', sans-serif; font-weight: 700;  
}

/* Style pour la légende sans ombre et coins arrondis */
.info.legend {
  color: #000000;  /* Texte violet foncé */
  padding: 10px;  /* Espace interne autour du texte */
  font-size: 10px;  /* Taille du texte */
  line-height: 1.6;  /* Hauteur de ligne pour améliorer la lisibilité */
/* Contour violet net autour du texte */
  text-shadow:
    -1px -1px 0 #e6ccff,
     1px -1px 0 #e6ccff,
    -1px  1px 0 #e6ccff,
     1px  1px 0 #e6ccff;
}

/* Style pour chaque élément de la légende */
.legend-item {
  display: flex;
  align-items: center;
  margin-bottom: 5px;
}

/* Style pour l'emoji dans la légende */
.legend-item .emoji {
  font-size: 14px;
  margin-right: 8px;
}

/* Style pour le nom de la catégorie */
.legend-item .category-name {
  font-size: 10px;
  font-weight: bold;
}

/* 12. Overlay d’intro === */
#intro-overlay {
  position: fixed; /* Position fixe pour couvrir toute la fenêtre */
  top: 0; /* Commence en haut de la page */
  left: 0; /* Commence à gauche de la page */
  width: 100%; /* Prend toute la largeur de l'écran */
  height: 100%; /* Prend toute la hauteur de l'écran */
  background-color: #0d0d0d; /* Fond sombre */
  background-image: url('./icons/background.jpg'); /* Image de fond de l'intro */
  background-size: cover; /* Taille de l'image couvre tout l'écran */
  background-position: center; /* L'image est centrée */
  background-attachment: fixed; /* Empêche le fond de défiler */
  z-index: 9999; /* Placer l'overlay au-dessus du contenu */
  display: flex; /* Utiliser Flexbox pour centrer le contenu */
  align-items: center; /* Centrer verticalement */
  justify-content: center; /* Centrer horizontalement */
  padding: 20px; /* Espacement autour du contenu */
  box-sizing: border-box; /* Inclure le padding dans la taille totale */
  text-align: center; /* Centrer le texte */
}

/* Texte global de l’intro (contenant les lignes) */
#intro-text {
  font-family: 'UnifrakturCook', cursive; /* Police d'introduction */
  font-size: 2.8em; /* Taille de la police de l'intro */
  color: #e60000; /* Couleur rouge du texte */
  text-shadow: 0 0 10px red; /* Ombre rouge autour du texte */
  line-height: 1.6; /* Espacement entre les lignes */
  text-align: center; /* Centrer le texte */
  animation: fadeIntro 8s forwards; /* Animation de fondu */
}

/* Ligne 1 : "Un territoire. Une carte." */
.line1 {
  display: inline-block; /* Affichage en ligne */
  white-space: nowrap; /* Empêcher le texte de passer à la ligne suivante */
  overflow: hidden; /* Masquer le texte qui déborde */
  width: 0; /* Initialiser la largeur à 0 pour l'animation */
  animation: typingLine1 4s steps(30, end) forwards; /* Animation de frappe */
}

/* Ligne 2 : "Un passé sombre." */
.line2 {
  display: inline-block; /* Affichage en ligne */
  white-space: nowrap; /* Empêcher le texte de passer à la ligne suivante */
  overflow: hidden; /* Masquer le texte qui déborde */
  width: 0; /* Initialiser la largeur à 0 pour l'animation */
  animation: typingLine2 3s steps(30, end) forwards; /* Animation de frappe plus rapide */
  animation-delay: 4s; /* Délai pour commencer après la première ligne */
  animation-fill-mode: forwards; /* Maintenir l'état final de l'animation */
}

/* Animation de frappe pour la ligne 1 */
@keyframes typingLine1 {
  to {
    width: 100%; /* Augmenter la largeur à 100% à la fin de l'animation */
  }
}

/* Animation de frappe pour la ligne 2 */
@keyframes typingLine2 {
  to {
    width: 100%; /* Augmenter la largeur à 100% à la fin de l'animation */
  }
}

/* Animation de fondu pour l'introduction */
@keyframes fadeIntro {
  0% {
    opacity: 0; /* Initialement invisible */
  }
  100% {
    opacity: 1; /* Devenir complètement visible */
  }
}

/* 14. PERSONNALISATION DU BOUTON DE LOCALISATION (Emoji Direct Hit Visible et Cliquable) === */
.leaflet-control-locate {
  background-color: transparent !important; /* Fond transparent */
  border: none !important; /* Pas de bordure */
  padding: 0 !important; /* Pas de rembourrage */
  width: auto !important; /* Ajuster la largeur au contenu */
  height: auto !important; /* Ajuster la hauteur au contenu */
  cursor: pointer; /* Curseur "main" */
  text-align: center !important; /* Centrer l'emoji */
  overflow: hidden !important; /* Empêcher débordement */
  display: flex !important; /* Utiliser flex pour centrer */
  justify-content: center !important; /* Centrage horizontal */
  align-items: center !important; /* Centrage vertical */
}

.leaflet-control-locate .leaflet-bar-part-single {
  background-color: transparent !important;
  border: none !important;
  padding: 5px !important; /* Un peu de padding pour l'interaction */
  width: auto !important;
  height: auto !important;
  cursor: pointer;
  text-align: center !important;
  font-size: 2.5em !important; /* Taille de l'emoji */
  line-height: 1 !important; /* Centrage vertical */
  color: inherit !important; /* IMPORTANT : Hériter de la couleur pour rendre l'emoji visible */
  text-shadow: none !important;
  display: flex !important; /* Utiliser flex pour centrer */
  justify-content: center !important; /* Centrage horizontal */
  align-items: center !important; /* Centrage vertical */
}

/* 15. Afficher l'emoji comme contenu de l'élément <a> */
.leaflet-control-locate .leaflet-bar-part-single::before {
  content: "🎯" !important; /* Emoji direct hit */
  display: block !important; /* Important pour que le pseudo-élément prenne de la place */
  width: 100%;
  height: 100%;
  line-height: inherit !important; /* Hériter pour le centrage vertical */
  font-size: inherit !important; /* Hériter de la taille définie sur l'<a> */
  text-align: center !important; /* S'assurer que l'emoji est centré */
  transition: transform 0.2s ease;  /* Animation douce */  
  /* On ne définit pas de couleur ici, on hérite de celle de l'élément <a> */
}
.leaflet-control-locate .leaflet-bar-part-single:hover::before {
  transform: scale(1.5); /* ✅ effet de grossissement uniquement au survol */
}

/* 16. PERSONNALISATION DU BOUTON DE CHANGEMENT DE FOND DE CARTE AVEC UN EMOJI 🗺️ === */
.leaflet-control-layers-toggle {
  background-color: transparent !important;
  background-image: none !important;
  width: auto !important;
  height: auto !important;
  border: none !important;
  font-size: 3.5em !important;
  line-height: 1 !important;
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
  cursor: pointer;
  color: inherit !important;
}

.leaflet-control-layers-toggle::before {
  content: "🗺️";
  display: block;
  font-size: inherit;
}

/* 17. Bouton dé === */
#randomButton {
    background-color: transparent !important;
    border: none !important;
    padding: 5px !important;
    width: auto !important;
    height: auto !important;
    cursor: pointer;
    text-align: center !important;
    font-size: 2.5em !important; /* même que 🎯 */
    line-height: 1 !important;
    color: inherit !important;
    text-shadow: none !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    /* Suppression de la marge ici, le positionnement se fera via Leaflet */
    overflow: visible !important; /* 🔥 empêche le rognage */
    transition: transform 0.2s ease; /* Ajout de la transition pour l'effet au survol */
}

#randomButton:hover {
    transform: scale(1.5);
}

#fullscreenButton {
    background-color: transparent !important;
    border: none !important;
    padding: 5px !important;
    width: auto !important;
    height: auto !important;
    cursor: pointer;
    text-align: center !important;
    font-size: 2.5em !important;
    line-height: 1 !important;
    color: inherit !important;
    text-shadow: none !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    overflow: visible !important;
    transition: transform 0.2s ease;
}

#fullscreenButton:hover {
    transform: scale(1.5);
}

/* 17. Positionnement des contrôles en haut à droite === */
.leaflet-topright {
    display: flex; /* Utiliser flex pour aligner les éléments verticalement */
    flex-direction: column; /* Aligner les éléments en colonne */
    align-items: flex-end; /* Aligner les éléments à droite */
    gap: 5px; /* Espacement vertical entre les boutons */
    padding: 10px; /* Marge autour du groupe de boutons */
}

.leaflet-control-custom {
    overflow: visible !important; /* 🔥 Leaflet limite parfois la taille à cause de ça */
}

/* 18. Footer === */
footer {
  width: 100%;                  /* Le footer prend toute la largeur de la page */
  margin: 0 auto;               /* ✅ Centre le bloc footer dans la page */
  text-align: center;           /* ✅ Centre le texte à l'intérieur du footer */
  padding: 20px;
  font-size: 0.6em;
  color: #000000;
  text-shadow:
    -1px -1px 0 #e6ccff,
     1px -1px 0 #e6ccff,
    -1px  1px 0 #e6ccff,
     1px  1px 0 #e6ccff;
}

/* === Adaptation des popups Leaflet === */
/* Largeur max du popup sur desktop restée par défaut */

/* 19. Adaptation des popups Leaflet pour mobile === */
@media (max-width: 768px) {
  /* limite la largeur du cadre */
  .leaflet-popup-content-wrapper {
    max-width: 334px !important;
  }
  /* applique à tout le contenu (texte, liens…) */
  .leaflet-popup-content,
  .leaflet-popup-content * {
    font-size: 12px !important;    /* taille fixe en px pour plus de contrôle */
    line-height: 1.2 !important;    /* interligne adapté */
  }
}

@media (max-width: 480px) {
  .leaflet-popup-content-wrapper {
    max-width: 240px !important;
  }
  .leaflet-popup-content,
  .leaflet-popup-content * {
    font-size: 10px !important;
    line-height: 1 !important;
  }
}

/* 20. Surcharge réglée en dernier pour prendre le pas */
body > #map {
  height: 60vh !important;
}
